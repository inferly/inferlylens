name: QualityChecks

on: [push]

jobs:
  check-and-test:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        python-version: ["3.11.0"]
      fail-fast: true

    name: Python-${{ matrix.python-version }}

    steps:
      #----------------------------------------------
      #       check-out repo and set up Python+uv
      #----------------------------------------------
      - name: Check out repository
        uses: actions/checkout@v5

      - name: Install uv and Python ${{ matrix.python-version }}
        uses: astral-sh/setup-uv@v7
        with:
          # matrix Python version
          python-version: ${{ matrix.python-version }}
          # let setup-uv persist uv's cache for you
          enable-cache: true

      #----------------------------------------------
      #       install dependencies (uv)
      #----------------------------------------------
      - name: Install dependencies
        run: uv sync --locked --dev
        # If you don't commit uv.lock yet, drop the --locked flag.

      #----------------------------------------------
      #              checks / lint / format
      #----------------------------------------------
      - name: Run checks
        run: uv run task check

      #----------------------------------------------
      #              run test suite
      #----------------------------------------------
      - name: Run tests
        run: uv run task test
